syntax = "v1"

// 角色信息
type Role {
	Id          int    `json:"id"`
	Name        string `json:"name"`
	Description string `json:"description"`
	Personality string `json:"personality"`
}

// 消息
type Message {
	Id        int    `json:"id"`
	RoleId    int    `json:"role_id"`
	Content   string `json:"content"`
	Timestamp string `json:"timestamp"`
}

// 获取角色列表请求
type GetRolesRequest {}

// 获取角色列表响应
type GetRolesResponse {
	Roles []Role `json:"roles"`
}

// 获取角色详情请求
type GetRoleRequest {
	Id int `path:"id"`
}

// 获取角色详情响应
type GetRoleResponse {
	Role Role `json:"role"`
}

// 发送消息请求
type SendMessageRequest {
	RoleId  int    `json:"role_id"`
	Content string `json:"content"`
}

// 发送消息响应
type SendMessageResponse {
	Message Message `json:"message"`
}

// 获取对话历史请求
type GetHistoryRequest {
	RoleId int `path:"role_id"`
}

// 获取对话历史响应
type GetHistoryResponse {
	Messages []Message `json:"messages"`
}

service roleplay-api {
	@handler GetRoles
	get /roles (GetRolesRequest) returns (GetRolesResponse)

	@handler GetRole
	get /roles/:id (GetRoleRequest) returns (GetRoleResponse)

	@handler SendMessage
	post /messages (SendMessageRequest) returns (SendMessageResponse)

	@handler GetHistory
	get /messages/:role_id (GetHistoryRequest) returns (GetHistoryResponse)
}

